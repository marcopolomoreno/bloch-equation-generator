//Source code generated by the Bloch Equation Generator application:
//https://simufisica.com/en/tools/bloch-equation-generator/"
//Developer: Marco Polo Moreno de Souza"
//Contact: marcopolo@unir.br
//Creation date: 19/04/2025
//Version of the generator 1.4.2

//All units are in SI

#include <stdio.h>
#include <math.h>

int main() {
    FILE* file;
    file = fopen("data.txt", "w");


    double const Pi = 3.14159265358979;

    //Number of Bloch equations
    int const N = 144;


    //Density matrix
    double rho[N];


    //Adjustments to be made (type control + F to find what needs to be adjusted)
    //Adjustments 1 - Spectrum and temporal integration
    //Adjustments 2 - Rabi frequencies
    //Adjustments 3 - Decays
    //Adjustments 4 - Initial conditions
    //Adjustments 5 - Detunings
    



    //****************** Adjustments 1 - Spectrum and temporal integration ******************//
    //********************************************************************************//
    //Spectrum width, in MHz
    double const spectrumWidth = 200;
    
    //Detuning step, in MHz
    double const passo = 1;

    //Interaction time, in s
    double const tTotal = 1e-6;

    //Time integration step, in s
    double const h = 5e-12;
    



    //******************* Adjustments 2 - Rabi frequencies ***************************//
    //*******************************************************************************//
	//Real part of Rabi frequencies
	double const rabiFreq = 0.2*2*Pi*5e6;

	double A18 = rabiFreq;
	double A29 = rabiFreq;
	double A310 = rabiFreq;
	double A411 = rabiFreq;
	double A512 = rabiFreq;

	//Imaginary part of Rabi frequencies
	double B18 = 0;
	double B29 = 0;
	double B310 = 0;
	double B411 = 0;
	double B512 = 0;




    //************************ Adjustments 3 - Decays ******************************//
    //*******************************************************************************//
	//Decay rates of excited states
	double const decay = 2*Pi*5e6;

	double Gamma61 = decay/1.0;
	double Gamma71 = decay/2.0;
	double Gamma81 = decay/3.0;
	double Gamma72 = decay/2.0;
	double Gamma82 = decay/3.0;
	double Gamma92 = decay/3.0;
	double Gamma83 = decay/3.0;
	double Gamma93 = decay/3.0;
	double Gamma103 = decay/3.0;
	double Gamma94 = decay/3.0;
	double Gamma104 = decay/3.0;
	double Gamma114 = decay/2.0;
	double Gamma105 = decay/3.0;
	double Gamma115 = decay/2.0;
	double Gamma125 = decay/1.0;

	//Decay rates of coherences
	double gamma12 = 0;
	double gamma13 = 0;
	double gamma14 = 0;
	double gamma15 = 0;
	double gamma16 = 0.5*decay;
	double gamma17 = 0.5*decay;
	double gamma18 = 0.5*decay;
	double gamma19 = 0.5*decay;
	double gamma110 = 0.5*decay;
	double gamma111 = 0.5*decay;
	double gamma112 = 0.5*decay;
	double gamma23 = 0;
	double gamma24 = 0;
	double gamma25 = 0;
	double gamma26 = 0.5*decay;
	double gamma27 = 0.5*decay;
	double gamma28 = 0.5*decay;
	double gamma29 = 0.5*decay;
	double gamma210 = 0.5*decay;
	double gamma211 = 0.5*decay;
	double gamma212 = 0.5*decay;
	double gamma34 = 0;
	double gamma35 = 0;
	double gamma36 = 0.5*decay;
	double gamma37 = 0.5*decay;
	double gamma38 = 0.5*decay;
	double gamma39 = 0.5*decay;
	double gamma310 = 0.5*decay;
	double gamma311 = 0.5*decay;
	double gamma312 = 0.5*decay;
	double gamma45 = 0;
	double gamma46 = 0.5*decay;
	double gamma47 = 0.5*decay;
	double gamma48 = 0.5*decay;
	double gamma49 = 0.5*decay;
	double gamma410 = 0.5*decay;
	double gamma411 = 0.5*decay;
	double gamma412 = 0.5*decay;
	double gamma56 = 0.5*decay;
	double gamma57 = 0.5*decay;
	double gamma58 = 0.5*decay;
	double gamma59 = 0.5*decay;
	double gamma510 = 0.5*decay;
	double gamma511 = 0.5*decay;
	double gamma512 = 0.5*decay;
	double gamma67 = decay;
	double gamma68 = decay;
	double gamma69 = decay;
	double gamma610 = decay;
	double gamma611 = decay;
	double gamma612 = decay;
	double gamma78 = decay;
	double gamma79 = decay;
	double gamma710 = decay;
	double gamma711 = decay;
	double gamma712 = decay;
	double gamma89 = decay;
	double gamma810 = decay;
	double gamma811 = decay;
	double gamma812 = decay;
	double gamma910 = decay;
	double gamma911 = decay;
	double gamma912 = decay;
	double gamma1011 = decay;
	double gamma1012 = decay;
	double gamma1112 = decay;
	//*******************************************************************************//



    
	//Detunings
	double delta21 = 0;
	double delta31 = 0;
	double delta41 = 0;
	double delta51 = 0;
	double delta61 = 0;
	double delta71 = 0;
	double delta81 = 0;
	double delta91 = 0;
	double delta101 = 0;
	double delta111 = 0;
	double delta121 = 0;
	double delta32 = 0;
	double delta42 = 0;
	double delta52 = 0;
	double delta62 = 0;
	double delta72 = 0;
	double delta82 = 0;
	double delta92 = 0;
	double delta102 = 0;
	double delta112 = 0;
	double delta122 = 0;
	double delta43 = 0;
	double delta53 = 0;
	double delta63 = 0;
	double delta73 = 0;
	double delta83 = 0;
	double delta93 = 0;
	double delta103 = 0;
	double delta113 = 0;
	double delta123 = 0;
	double delta54 = 0;
	double delta64 = 0;
	double delta74 = 0;
	double delta84 = 0;
	double delta94 = 0;
	double delta104 = 0;
	double delta114 = 0;
	double delta124 = 0;
	double delta65 = 0;
	double delta75 = 0;
	double delta85 = 0;
	double delta95 = 0;
	double delta105 = 0;
	double delta115 = 0;
	double delta125 = 0;
	double delta76 = 0;
	double delta86 = 0;
	double delta96 = 0;
	double delta106 = 0;
	double delta116 = 0;
	double delta126 = 0;
	double delta87 = 0;
	double delta97 = 0;
	double delta107 = 0;
	double delta117 = 0;
	double delta127 = 0;
	double delta98 = 0;
	double delta108 = 0;
	double delta118 = 0;
	double delta128 = 0;
	double delta109 = 0;
	double delta119 = 0;
	double delta129 = 0;
	double delta1110 = 0;
	double delta1210 = 0;
	double delta1211 = 0;




    //************************ Adjustments 4 - Initial conditions ***********************//
    //*******************************************************************************//
	//Initial populations
	double pop[N+1];
	pop[1] = 1.0/5.0;
	pop[2] = 1.0/5.0;
	pop[3] = 1.0/5.0;
	pop[4] = 1.0/5.0;
	pop[5] = 1.0/5.0;
	pop[6] = 0;
	pop[7] = 0;
	pop[8] = 0;
	pop[9] = 0;
	pop[10] = 0;
	pop[11] = 0;
	pop[12] = 0;

	//Initial coherences
	pop[13] = 0;
	pop[14] = 0;
	pop[15] = 0;
	pop[16] = 0;
	pop[17] = 0;
	pop[18] = 0;
	pop[19] = 0;
	pop[20] = 0;
	pop[21] = 0;
	pop[22] = 0;
	pop[23] = 0;
	pop[24] = 0;
	pop[25] = 0;
	pop[26] = 0;
	pop[27] = 0;
	pop[28] = 0;
	pop[29] = 0;
	pop[30] = 0;
	pop[31] = 0;
	pop[32] = 0;
	pop[33] = 0;
	pop[34] = 0;
	pop[35] = 0;
	pop[36] = 0;
	pop[37] = 0;
	pop[38] = 0;
	pop[39] = 0;
	pop[40] = 0;
	pop[41] = 0;
	pop[42] = 0;
	pop[43] = 0;
	pop[44] = 0;
	pop[45] = 0;
	pop[46] = 0;
	pop[47] = 0;
	pop[48] = 0;
	pop[49] = 0;
	pop[50] = 0;
	pop[51] = 0;
	pop[52] = 0;
	pop[53] = 0;
	pop[54] = 0;
	pop[55] = 0;
	pop[56] = 0;
	pop[57] = 0;
	pop[58] = 0;
	pop[59] = 0;
	pop[60] = 0;
	pop[61] = 0;
	pop[62] = 0;
	pop[63] = 0;
	pop[64] = 0;
	pop[65] = 0;
	pop[66] = 0;
	pop[67] = 0;
	pop[68] = 0;
	pop[69] = 0;
	pop[70] = 0;
	pop[71] = 0;
	pop[72] = 0;
	pop[73] = 0;
	pop[74] = 0;
	pop[75] = 0;
	pop[76] = 0;
	pop[77] = 0;
	pop[78] = 0;
	pop[79] = 0;
	pop[80] = 0;
	pop[81] = 0;
	pop[82] = 0;
	pop[83] = 0;
	pop[84] = 0;
	pop[85] = 0;
	pop[86] = 0;
	pop[87] = 0;
	pop[88] = 0;
	pop[89] = 0;
	pop[90] = 0;
	pop[91] = 0;
	pop[92] = 0;
	pop[93] = 0;
	pop[94] = 0;
	pop[95] = 0;
	pop[96] = 0;
	pop[97] = 0;
	pop[98] = 0;
	pop[99] = 0;
	pop[100] = 0;
	pop[101] = 0;
	pop[102] = 0;
	pop[103] = 0;
	pop[104] = 0;
	pop[105] = 0;
	pop[106] = 0;
	pop[107] = 0;
	pop[108] = 0;
	pop[109] = 0;
	pop[110] = 0;
	pop[111] = 0;
	pop[112] = 0;
	pop[113] = 0;
	pop[114] = 0;
	pop[115] = 0;
	pop[116] = 0;
	pop[117] = 0;
	pop[118] = 0;
	pop[119] = 0;
	pop[120] = 0;
	pop[121] = 0;
	pop[122] = 0;
	pop[123] = 0;
	pop[124] = 0;
	pop[125] = 0;
	pop[126] = 0;
	pop[127] = 0;
	pop[128] = 0;
	pop[129] = 0;
	pop[130] = 0;
	pop[131] = 0;
	pop[132] = 0;
	pop[133] = 0;
	pop[134] = 0;
	pop[135] = 0;
	pop[136] = 0;
	pop[137] = 0;
	pop[138] = 0;
	pop[139] = 0;
	pop[140] = 0;
	pop[141] = 0;
	pop[142] = 0;
	pop[143] = 0;
	pop[144] = 0;
	//*******************************************************************************//
    



    //Number of detuning points
    double D = spectrumWidth/(2*passo);

    //Tempo
    double t;
    
    //Number of time points
    double T = tTotal/h + 1;


    //Variables - data.txt file
	fprintf(file, "\\g(d)\\-(21)/2\\g(p) \\g(r)\\-(11) \\g(r)\\-(22) \\g(r)\\-(33) \\g(r)\\-(44) \\g(r)\\-(55) \\g(r)\\-(66) \\g(r)\\-(77) \\g(r)\\-(88) \\g(r)\\-(99) \\g(r)\\-(1010) \\g(r)\\-(1111) \\g(r)\\-(1212) Re(\\g(s)\\-(12)) Im(\\g(s)\\-(12)) Re(\\g(s)\\-(13)) Im(\\g(s)\\-(13)) Re(\\g(s)\\-(14)) Im(\\g(s)\\-(14)) Re(\\g(s)\\-(15)) Im(\\g(s)\\-(15)) Re(\\g(s)\\-(16)) Im(\\g(s)\\-(16)) Re(\\g(s)\\-(17)) Im(\\g(s)\\-(17)) Re(\\g(s)\\-(18)) Im(\\g(s)\\-(18)) Re(\\g(s)\\-(19)) Im(\\g(s)\\-(19)) Re(\\g(s)\\-(110)) Im(\\g(s)\\-(110)) Re(\\g(s)\\-(111)) Im(\\g(s)\\-(111)) Re(\\g(s)\\-(112)) Im(\\g(s)\\-(112)) Re(\\g(s)\\-(23)) Im(\\g(s)\\-(23)) Re(\\g(s)\\-(24)) Im(\\g(s)\\-(24)) Re(\\g(s)\\-(25)) Im(\\g(s)\\-(25)) Re(\\g(s)\\-(26)) Im(\\g(s)\\-(26)) Re(\\g(s)\\-(27)) Im(\\g(s)\\-(27)) Re(\\g(s)\\-(28)) Im(\\g(s)\\-(28)) Re(\\g(s)\\-(29)) Im(\\g(s)\\-(29)) Re(\\g(s)\\-(210)) Im(\\g(s)\\-(210)) Re(\\g(s)\\-(211)) Im(\\g(s)\\-(211)) Re(\\g(s)\\-(212)) Im(\\g(s)\\-(212)) Re(\\g(s)\\-(34)) Im(\\g(s)\\-(34)) Re(\\g(s)\\-(35)) Im(\\g(s)\\-(35)) Re(\\g(s)\\-(36)) Im(\\g(s)\\-(36)) Re(\\g(s)\\-(37)) Im(\\g(s)\\-(37)) Re(\\g(s)\\-(38)) Im(\\g(s)\\-(38)) Re(\\g(s)\\-(39)) Im(\\g(s)\\-(39)) Re(\\g(s)\\-(310)) Im(\\g(s)\\-(310)) Re(\\g(s)\\-(311)) Im(\\g(s)\\-(311)) Re(\\g(s)\\-(312)) Im(\\g(s)\\-(312)) Re(\\g(s)\\-(45)) Im(\\g(s)\\-(45)) Re(\\g(s)\\-(46)) Im(\\g(s)\\-(46)) Re(\\g(s)\\-(47)) Im(\\g(s)\\-(47)) Re(\\g(s)\\-(48)) Im(\\g(s)\\-(48)) Re(\\g(s)\\-(49)) Im(\\g(s)\\-(49)) Re(\\g(s)\\-(410)) Im(\\g(s)\\-(410)) Re(\\g(s)\\-(411)) Im(\\g(s)\\-(411)) Re(\\g(s)\\-(412)) Im(\\g(s)\\-(412)) Re(\\g(s)\\-(56)) Im(\\g(s)\\-(56)) Re(\\g(s)\\-(57)) Im(\\g(s)\\-(57)) Re(\\g(s)\\-(58)) Im(\\g(s)\\-(58)) Re(\\g(s)\\-(59)) Im(\\g(s)\\-(59)) Re(\\g(s)\\-(510)) Im(\\g(s)\\-(510)) Re(\\g(s)\\-(511)) Im(\\g(s)\\-(511)) Re(\\g(s)\\-(512)) Im(\\g(s)\\-(512)) Re(\\g(s)\\-(67)) Im(\\g(s)\\-(67)) Re(\\g(s)\\-(68)) Im(\\g(s)\\-(68)) Re(\\g(s)\\-(69)) Im(\\g(s)\\-(69)) Re(\\g(s)\\-(610)) Im(\\g(s)\\-(610)) Re(\\g(s)\\-(611)) Im(\\g(s)\\-(611)) Re(\\g(s)\\-(612)) Im(\\g(s)\\-(612)) Re(\\g(s)\\-(78)) Im(\\g(s)\\-(78)) Re(\\g(s)\\-(79)) Im(\\g(s)\\-(79)) Re(\\g(s)\\-(710)) Im(\\g(s)\\-(710)) Re(\\g(s)\\-(711)) Im(\\g(s)\\-(711)) Re(\\g(s)\\-(712)) Im(\\g(s)\\-(712)) Re(\\g(s)\\-(89)) Im(\\g(s)\\-(89)) Re(\\g(s)\\-(810)) Im(\\g(s)\\-(810)) Re(\\g(s)\\-(811)) Im(\\g(s)\\-(811)) Re(\\g(s)\\-(812)) Im(\\g(s)\\-(812)) Re(\\g(s)\\-(910)) Im(\\g(s)\\-(910)) Re(\\g(s)\\-(911)) Im(\\g(s)\\-(911)) Re(\\g(s)\\-(912)) Im(\\g(s)\\-(912)) Re(\\g(s)\\-(1011)) Im(\\g(s)\\-(1011)) Re(\\g(s)\\-(1012)) Im(\\g(s)\\-(1012)) Re(\\g(s)\\-(1112)) Im(\\g(s)\\-(1112))\n");
	fprintf(file, "MHz                                                                                                                                                \n");




    //***************************** Bloch equations *********************************//
    //*********************************************************************************//
	double bloch(double a11, double a22, double a33, double a44, double a55, double a66, double a77, double a88, double a99, double a1010, double a1111, double a1212, double a12, double b12, double a13, double b13, double a14, double b14, double a15, double b15, double a16, double b16, double a17, double b17, double a18, double b18, double a19, double b19, double a110, double b110, double a111, double b111, double a112, double b112, double a23, double b23, double a24, double b24, double a25, double b25, double a26, double b26, double a27, double b27, double a28, double b28, double a29, double b29, double a210, double b210, double a211, double b211, double a212, double b212, double a34, double b34, double a35, double b35, double a36, double b36, double a37, double b37, double a38, double b38, double a39, double b39, double a310, double b310, double a311, double b311, double a312, double b312, double a45, double b45, double a46, double b46, double a47, double b47, double a48, double b48, double a49, double b49, double a410, double b410, double a411, double b411, double a412, double b412, double a56, double b56, double a57, double b57, double a58, double b58, double a59, double b59, double a510, double b510, double a511, double b511, double a512, double b512, double a67, double b67, double a68, double b68, double a69, double b69, double a610, double b610, double a611, double b611, double a612, double b612, double a78, double b78, double a79, double b79, double a710, double b710, double a711, double b711, double a712, double b712, double a89, double b89, double a810, double b810, double a811, double b811, double a812, double b812, double a910, double b910, double a911, double b911, double a912, double b912, double a1011, double b1011, double a1012, double b1012, double a1112, double b1112, int j)
    {
		/*a11*/ if (j == 0) return - 2*a18*B18 + 2*b18*A18 + Gamma61*a66 + Gamma71*a77 + Gamma81*a88;
		/*a22*/ if (j == 1) return - 2*a29*B29 + 2*b29*A29 + Gamma72*a77 + Gamma82*a88 + Gamma92*a99;
		/*a33*/ if (j == 2) return - 2*a310*B310 + 2*b310*A310 + Gamma83*a88 + Gamma93*a99 + Gamma103*a1010;
		/*a44*/ if (j == 3) return - 2*a411*B411 + 2*b411*A411 + Gamma94*a99 + Gamma104*a1010 + Gamma114*a1111;
		/*a55*/ if (j == 4) return - 2*a512*B512 + 2*b512*A512 + Gamma105*a1010 + Gamma115*a1111 + Gamma125*a1212;
		/*a66*/ if (j == 5) return - Gamma61*a66;
		/*a77*/ if (j == 6) return - Gamma71*a77 - Gamma72*a77;
		/*a88*/ if (j == 7) return + 2*a18*B18 - 2*b18*A18 - Gamma81*a88 - Gamma82*a88 - Gamma83*a88;
		/*a99*/ if (j == 8) return + 2*a29*B29 - 2*b29*A29 - Gamma92*a99 - Gamma93*a99 - Gamma94*a99;
		/*a1010*/ if (j == 9) return + 2*a310*B310 - 2*b310*A310 - Gamma103*a1010 - Gamma104*a1010 - Gamma105*a1010;
		/*a1111*/ if (j == 10) return + 2*a411*B411 - 2*b411*A411 - Gamma114*a1111 - Gamma115*a1111;
		/*a1212*/ if (j == 11) return + 2*a512*B512 - 2*b512*A512 - Gamma125*a1212;
		/*a12*/ if (j == 12) return -gamma12*a12 - delta21*b12 - a28*B18 + b28*A18 - a19*B29 + b19*A29;
		/*b12*/ if (j == 13) return -gamma12*b12 + delta21*a12 + a28*A18 + b28*B18 - a19*A29 - b19*B29;
		/*a13*/ if (j == 14) return -gamma13*a13 - delta31*b13 - a38*B18 + b38*A18 - a110*B310 + b110*A310;
		/*b13*/ if (j == 15) return -gamma13*b13 + delta31*a13 + a38*A18 + b38*B18 - a110*A310 - b110*B310;
		/*a14*/ if (j == 16) return -gamma14*a14 - delta41*b14 - a48*B18 + b48*A18 - a111*B411 + b111*A411;
		/*b14*/ if (j == 17) return -gamma14*b14 + delta41*a14 + a48*A18 + b48*B18 - a111*A411 - b111*B411;
		/*a15*/ if (j == 18) return -gamma15*a15 - delta51*b15 - a58*B18 + b58*A18 - a112*B512 + b112*A512;
		/*b15*/ if (j == 19) return -gamma15*b15 + delta51*a15 + a58*A18 + b58*B18 - a112*A512 - b112*B512;
		/*a16*/ if (j == 20) return -gamma16*a16 - delta61*b16 - a68*B18 + b68*A18;
		/*b16*/ if (j == 21) return -gamma16*b16 + delta61*a16 + a68*A18 + b68*B18;
		/*a17*/ if (j == 22) return -gamma17*a17 - delta71*b17 - a78*B18 + b78*A18;
		/*b17*/ if (j == 23) return -gamma17*b17 + delta71*a17 + a78*A18 + b78*B18;
		/*a18*/ if (j == 24) return -gamma18*a18 - delta81*b18 - B18*(a88 - a11);
		/*b18*/ if (j == 25) return -gamma18*b18 + delta81*a18 + A18*(a88 - a11);
		/*a19*/ if (j == 26) return -gamma19*a19 - delta91*b19 + a12*B29 + b12*A29 - a89*B18 - b89*A18;
		/*b19*/ if (j == 27) return -gamma19*b19 + delta91*a19 - a12*A29 + b12*B29 + a89*A18 - b89*B18;
		/*a110*/ if (j == 28) return -gamma110*a110 - delta101*b110 + a13*B310 + b13*A310 - a810*B18 - b810*A18;
		/*b110*/ if (j == 29) return -gamma110*b110 + delta101*a110 - a13*A310 + b13*B310 + a810*A18 - b810*B18;
		/*a111*/ if (j == 30) return -gamma111*a111 - delta111*b111 + a14*B411 + b14*A411 - a811*B18 - b811*A18;
		/*b111*/ if (j == 31) return -gamma111*b111 + delta111*a111 - a14*A411 + b14*B411 + a811*A18 - b811*B18;
		/*a112*/ if (j == 32) return -gamma112*a112 - delta121*b112 + a15*B512 + b15*A512 - a812*B18 - b812*A18;
		/*b112*/ if (j == 33) return -gamma112*b112 + delta121*a112 - a15*A512 + b15*B512 + a812*A18 - b812*B18;
		/*a23*/ if (j == 34) return -gamma23*a23 - delta32*b23 - a39*B29 + b39*A29 - a210*B310 + b210*A310;
		/*b23*/ if (j == 35) return -gamma23*b23 + delta32*a23 + a39*A29 + b39*B29 - a210*A310 - b210*B310;
		/*a24*/ if (j == 36) return -gamma24*a24 - delta42*b24 - a49*B29 + b49*A29 - a211*B411 + b211*A411;
		/*b24*/ if (j == 37) return -gamma24*b24 + delta42*a24 + a49*A29 + b49*B29 - a211*A411 - b211*B411;
		/*a25*/ if (j == 38) return -gamma25*a25 - delta52*b25 - a59*B29 + b59*A29 - a212*B512 + b212*A512;
		/*b25*/ if (j == 39) return -gamma25*b25 + delta52*a25 + a59*A29 + b59*B29 - a212*A512 - b212*B512;
		/*a26*/ if (j == 40) return -gamma26*a26 - delta62*b26 - a69*B29 + b69*A29;
		/*b26*/ if (j == 41) return -gamma26*b26 + delta62*a26 + a69*A29 + b69*B29;
		/*a27*/ if (j == 42) return -gamma27*a27 - delta72*b27 - a79*B29 + b79*A29;
		/*b27*/ if (j == 43) return -gamma27*b27 + delta72*a27 + a79*A29 + b79*B29;
		/*a28*/ if (j == 44) return -gamma28*a28 - delta82*b28 + a12*B18 - b12*A18 - a89*B29 + b89*A29;
		/*b28*/ if (j == 45) return -gamma28*b28 + delta82*a28 - a12*A18 - b12*B18 + a89*A29 + b89*B29;
		/*a29*/ if (j == 46) return -gamma29*a29 - delta92*b29 - B29*(a99 - a22);
		/*b29*/ if (j == 47) return -gamma29*b29 + delta92*a29 + A29*(a99 - a22);
		/*a210*/ if (j == 48) return -gamma210*a210 - delta102*b210 + a23*B310 + b23*A310 - a910*B29 - b910*A29;
		/*b210*/ if (j == 49) return -gamma210*b210 + delta102*a210 - a23*A310 + b23*B310 + a910*A29 - b910*B29;
		/*a211*/ if (j == 50) return -gamma211*a211 - delta112*b211 + a24*B411 + b24*A411 - a911*B29 - b911*A29;
		/*b211*/ if (j == 51) return -gamma211*b211 + delta112*a211 - a24*A411 + b24*B411 + a911*A29 - b911*B29;
		/*a212*/ if (j == 52) return -gamma212*a212 - delta122*b212 + a25*B512 + b25*A512 - a912*B29 - b912*A29;
		/*b212*/ if (j == 53) return -gamma212*b212 + delta122*a212 - a25*A512 + b25*B512 + a912*A29 - b912*B29;
		/*a34*/ if (j == 54) return -gamma34*a34 - delta43*b34 - a410*B310 + b410*A310 - a311*B411 + b311*A411;
		/*b34*/ if (j == 55) return -gamma34*b34 + delta43*a34 + a410*A310 + b410*B310 - a311*A411 - b311*B411;
		/*a35*/ if (j == 56) return -gamma35*a35 - delta53*b35 - a510*B310 + b510*A310 - a312*B512 + b312*A512;
		/*b35*/ if (j == 57) return -gamma35*b35 + delta53*a35 + a510*A310 + b510*B310 - a312*A512 - b312*B512;
		/*a36*/ if (j == 58) return -gamma36*a36 - delta63*b36 - a610*B310 + b610*A310;
		/*b36*/ if (j == 59) return -gamma36*b36 + delta63*a36 + a610*A310 + b610*B310;
		/*a37*/ if (j == 60) return -gamma37*a37 - delta73*b37 - a710*B310 + b710*A310;
		/*b37*/ if (j == 61) return -gamma37*b37 + delta73*a37 + a710*A310 + b710*B310;
		/*a38*/ if (j == 62) return -gamma38*a38 - delta83*b38 + a13*B18 - b13*A18 - a810*B310 + b810*A310;
		/*b38*/ if (j == 63) return -gamma38*b38 + delta83*a38 - a13*A18 - b13*B18 + a810*A310 + b810*B310;
		/*a39*/ if (j == 64) return -gamma39*a39 - delta93*b39 + a23*B29 - b23*A29 - a910*B310 + b910*A310;
		/*b39*/ if (j == 65) return -gamma39*b39 + delta93*a39 - a23*A29 - b23*B29 + a910*A310 + b910*B310;
		/*a310*/ if (j == 66) return -gamma310*a310 - delta103*b310 - B310*(a1010 - a33);
		/*b310*/ if (j == 67) return -gamma310*b310 + delta103*a310 + A310*(a1010 - a33);
		/*a311*/ if (j == 68) return -gamma311*a311 - delta113*b311 + a34*B411 + b34*A411 - a1011*B310 - b1011*A310;
		/*b311*/ if (j == 69) return -gamma311*b311 + delta113*a311 - a34*A411 + b34*B411 + a1011*A310 - b1011*B310;
		/*a312*/ if (j == 70) return -gamma312*a312 - delta123*b312 + a35*B512 + b35*A512 - a1012*B310 - b1012*A310;
		/*b312*/ if (j == 71) return -gamma312*b312 + delta123*a312 - a35*A512 + b35*B512 + a1012*A310 - b1012*B310;
		/*a45*/ if (j == 72) return -gamma45*a45 - delta54*b45 - a511*B411 + b511*A411 - a412*B512 + b412*A512;
		/*b45*/ if (j == 73) return -gamma45*b45 + delta54*a45 + a511*A411 + b511*B411 - a412*A512 - b412*B512;
		/*a46*/ if (j == 74) return -gamma46*a46 - delta64*b46 - a611*B411 + b611*A411;
		/*b46*/ if (j == 75) return -gamma46*b46 + delta64*a46 + a611*A411 + b611*B411;
		/*a47*/ if (j == 76) return -gamma47*a47 - delta74*b47 - a711*B411 + b711*A411;
		/*b47*/ if (j == 77) return -gamma47*b47 + delta74*a47 + a711*A411 + b711*B411;
		/*a48*/ if (j == 78) return -gamma48*a48 - delta84*b48 + a14*B18 - b14*A18 - a811*B411 + b811*A411;
		/*b48*/ if (j == 79) return -gamma48*b48 + delta84*a48 - a14*A18 - b14*B18 + a811*A411 + b811*B411;
		/*a49*/ if (j == 80) return -gamma49*a49 - delta94*b49 + a24*B29 - b24*A29 - a911*B411 + b911*A411;
		/*b49*/ if (j == 81) return -gamma49*b49 + delta94*a49 - a24*A29 - b24*B29 + a911*A411 + b911*B411;
		/*a410*/ if (j == 82) return -gamma410*a410 - delta104*b410 + a34*B310 - b34*A310 - a1011*B411 + b1011*A411;
		/*b410*/ if (j == 83) return -gamma410*b410 + delta104*a410 - a34*A310 - b34*B310 + a1011*A411 + b1011*B411;
		/*a411*/ if (j == 84) return -gamma411*a411 - delta114*b411 - B411*(a1111 - a44);
		/*b411*/ if (j == 85) return -gamma411*b411 + delta114*a411 + A411*(a1111 - a44);
		/*a412*/ if (j == 86) return -gamma412*a412 - delta124*b412 + a45*B512 + b45*A512 - a1112*B411 - b1112*A411;
		/*b412*/ if (j == 87) return -gamma412*b412 + delta124*a412 - a45*A512 + b45*B512 + a1112*A411 - b1112*B411;
		/*a56*/ if (j == 88) return -gamma56*a56 - delta65*b56 - a612*B512 + b612*A512;
		/*b56*/ if (j == 89) return -gamma56*b56 + delta65*a56 + a612*A512 + b612*B512;
		/*a57*/ if (j == 90) return -gamma57*a57 - delta75*b57 - a712*B512 + b712*A512;
		/*b57*/ if (j == 91) return -gamma57*b57 + delta75*a57 + a712*A512 + b712*B512;
		/*a58*/ if (j == 92) return -gamma58*a58 - delta85*b58 + a15*B18 - b15*A18 - a812*B512 + b812*A512;
		/*b58*/ if (j == 93) return -gamma58*b58 + delta85*a58 - a15*A18 - b15*B18 + a812*A512 + b812*B512;
		/*a59*/ if (j == 94) return -gamma59*a59 - delta95*b59 + a25*B29 - b25*A29 - a912*B512 + b912*A512;
		/*b59*/ if (j == 95) return -gamma59*b59 + delta95*a59 - a25*A29 - b25*B29 + a912*A512 + b912*B512;
		/*a510*/ if (j == 96) return -gamma510*a510 - delta105*b510 + a35*B310 - b35*A310 - a1012*B512 + b1012*A512;
		/*b510*/ if (j == 97) return -gamma510*b510 + delta105*a510 - a35*A310 - b35*B310 + a1012*A512 + b1012*B512;
		/*a511*/ if (j == 98) return -gamma511*a511 - delta115*b511 + a45*B411 - b45*A411 - a1112*B512 + b1112*A512;
		/*b511*/ if (j == 99) return -gamma511*b511 + delta115*a511 - a45*A411 - b45*B411 + a1112*A512 + b1112*B512;
		/*a512*/ if (j == 100) return -gamma512*a512 - delta125*b512 - B512*(a1212 - a55);
		/*b512*/ if (j == 101) return -gamma512*b512 + delta125*a512 + A512*(a1212 - a55);
		/*a67*/ if (j == 102) return -gamma67*a67 - delta76*b67;
		/*b67*/ if (j == 103) return -gamma67*b67 + delta76*a67;
		/*a68*/ if (j == 104) return -gamma68*a68 - delta86*b68 + a16*B18 - b16*A18;
		/*b68*/ if (j == 105) return -gamma68*b68 + delta86*a68 - a16*A18 - b16*B18;
		/*a69*/ if (j == 106) return -gamma69*a69 - delta96*b69 + a26*B29 - b26*A29;
		/*b69*/ if (j == 107) return -gamma69*b69 + delta96*a69 - a26*A29 - b26*B29;
		/*a610*/ if (j == 108) return -gamma610*a610 - delta106*b610 + a36*B310 - b36*A310;
		/*b610*/ if (j == 109) return -gamma610*b610 + delta106*a610 - a36*A310 - b36*B310;
		/*a611*/ if (j == 110) return -gamma611*a611 - delta116*b611 + a46*B411 - b46*A411;
		/*b611*/ if (j == 111) return -gamma611*b611 + delta116*a611 - a46*A411 - b46*B411;
		/*a612*/ if (j == 112) return -gamma612*a612 - delta126*b612 + a56*B512 - b56*A512;
		/*b612*/ if (j == 113) return -gamma612*b612 + delta126*a612 - a56*A512 - b56*B512;
		/*a78*/ if (j == 114) return -gamma78*a78 - delta87*b78 + a17*B18 - b17*A18;
		/*b78*/ if (j == 115) return -gamma78*b78 + delta87*a78 - a17*A18 - b17*B18;
		/*a79*/ if (j == 116) return -gamma79*a79 - delta97*b79 + a27*B29 - b27*A29;
		/*b79*/ if (j == 117) return -gamma79*b79 + delta97*a79 - a27*A29 - b27*B29;
		/*a710*/ if (j == 118) return -gamma710*a710 - delta107*b710 + a37*B310 - b37*A310;
		/*b710*/ if (j == 119) return -gamma710*b710 + delta107*a710 - a37*A310 - b37*B310;
		/*a711*/ if (j == 120) return -gamma711*a711 - delta117*b711 + a47*B411 - b47*A411;
		/*b711*/ if (j == 121) return -gamma711*b711 + delta117*a711 - a47*A411 - b47*B411;
		/*a712*/ if (j == 122) return -gamma712*a712 - delta127*b712 + a57*B512 - b57*A512;
		/*b712*/ if (j == 123) return -gamma712*b712 + delta127*a712 - a57*A512 - b57*B512;
		/*a89*/ if (j == 124) return -gamma89*a89 - delta98*b89 + a19*B18 - b19*A18 + a28*B29 - b28*A29;
		/*b89*/ if (j == 125) return -gamma89*b89 + delta98*a89 + a19*A18 + b19*B18 - a28*A29 - b28*B29;
		/*a810*/ if (j == 126) return -gamma810*a810 - delta108*b810 + a110*B18 - b110*A18 + a38*B310 - b38*A310;
		/*b810*/ if (j == 127) return -gamma810*b810 + delta108*a810 + a110*A18 + b110*B18 - a38*A310 - b38*B310;
		/*a811*/ if (j == 128) return -gamma811*a811 - delta118*b811 + a111*B18 - b111*A18 + a48*B411 - b48*A411;
		/*b811*/ if (j == 129) return -gamma811*b811 + delta118*a811 + a111*A18 + b111*B18 - a48*A411 - b48*B411;
		/*a812*/ if (j == 130) return -gamma812*a812 - delta128*b812 + a112*B18 - b112*A18 + a58*B512 - b58*A512;
		/*b812*/ if (j == 131) return -gamma812*b812 + delta128*a812 + a112*A18 + b112*B18 - a58*A512 - b58*B512;
		/*a910*/ if (j == 132) return -gamma910*a910 - delta109*b910 + a210*B29 - b210*A29 + a39*B310 - b39*A310;
		/*b910*/ if (j == 133) return -gamma910*b910 + delta109*a910 + a210*A29 + b210*B29 - a39*A310 - b39*B310;
		/*a911*/ if (j == 134) return -gamma911*a911 - delta119*b911 + a211*B29 - b211*A29 + a49*B411 - b49*A411;
		/*b911*/ if (j == 135) return -gamma911*b911 + delta119*a911 + a211*A29 + b211*B29 - a49*A411 - b49*B411;
		/*a912*/ if (j == 136) return -gamma912*a912 - delta129*b912 + a212*B29 - b212*A29 + a59*B512 - b59*A512;
		/*b912*/ if (j == 137) return -gamma912*b912 + delta129*a912 + a212*A29 + b212*B29 - a59*A512 - b59*B512;
		/*a1011*/ if (j == 138) return -gamma1011*a1011 - delta1110*b1011 + a311*B310 - b311*A310 + a410*B411 - b410*A411;
		/*b1011*/ if (j == 139) return -gamma1011*b1011 + delta1110*a1011 + a311*A310 + b311*B310 - a410*A411 - b410*B411;
		/*a1012*/ if (j == 140) return -gamma1012*a1012 - delta1210*b1012 + a312*B310 - b312*A310 + a510*B512 - b510*A512;
		/*b1012*/ if (j == 141) return -gamma1012*b1012 + delta1210*a1012 + a312*A310 + b312*B310 - a510*A512 - b510*B512;
		/*a1112*/ if (j == 142) return -gamma1112*a1112 - delta1211*b1112 + a412*B411 - b412*A411 + a511*B512 - b511*A512;
		/*b1112*/ if (j == 143) return -gamma1112*b1112 + delta1211*a1112 + a412*A411 + b412*B411 - a511*A512 - b511*B512;
    }
    //*********************************************************************************//


    int d, k, j;


    //Detuning loop
    for (d=-D; d<=D; d++)
    {
        t = 0;
        for (j=0; j<=N-1; j++)
            rho[j] = pop[j+1];
    

        //************************** Adjustments 5 - Detunings ***************************//
        //*******************************************************************************//
    
		//delta21 = 2*Pi*passo*d*1e6;   //Field sweeping frequency
		delta81 = 2*Pi*passo*d*1e6;
		delta92 = delta81;
		delta103 = delta81;
		delta114 = delta81;
		delta125 = delta81;

		//Two-photon coherences

		//Three-photon or more coherences: adjust if they exist

        //*******************************************************************//


        //Temporal loop
        for (k=0; k<=T; k++)
        {
			double k1[144], k2[144], k3[144], k4[144];

            //Step 1
			for (j=0; j<=N-1; j++)
			{
				k1[j] = bloch(rho[0], rho[1], rho[2], rho[3], rho[4], rho[5], rho[6], rho[7], rho[8], rho[9], rho[10], rho[11], rho[12], rho[13], rho[14], rho[15], rho[16], rho[17], rho[18], rho[19], rho[20], rho[21], rho[22], rho[23], rho[24], rho[25], rho[26], rho[27], rho[28], rho[29], rho[30], rho[31], rho[32], rho[33], rho[34], rho[35], rho[36], rho[37], rho[38], rho[39], rho[40], rho[41], rho[42], rho[43], rho[44], rho[45], rho[46], rho[47], rho[48], rho[49], rho[50], rho[51], rho[52], rho[53], rho[54], rho[55], rho[56], rho[57], rho[58], rho[59], rho[60], rho[61], rho[62], rho[63], rho[64], rho[65], rho[66], rho[67], rho[68], rho[69], rho[70], rho[71], rho[72], rho[73], rho[74], rho[75], rho[76], rho[77], rho[78], rho[79], rho[80], rho[81], rho[82], rho[83], rho[84], rho[85], rho[86], rho[87], rho[88], rho[89], rho[90], rho[91], rho[92], rho[93], rho[94], rho[95], rho[96], rho[97], rho[98], rho[99], rho[100], rho[101], rho[102], rho[103], rho[104], rho[105], rho[106], rho[107], rho[108], rho[109], rho[110], rho[111], rho[112], rho[113], rho[114], rho[115], rho[116], rho[117], rho[118], rho[119], rho[120], rho[121], rho[122], rho[123], rho[124], rho[125], rho[126], rho[127], rho[128], rho[129], rho[130], rho[131], rho[132], rho[133], rho[134], rho[135], rho[136], rho[137], rho[138], rho[139], rho[140], rho[141], rho[142], rho[143], j);
			}

            //Step 2
			for (j=0; j<=N-1; j++)
			{
				k2[j] = bloch(rho[0] + 0.5*h*k1[0], rho[1] + 0.5*h*k1[1], rho[2] + 0.5*h*k1[2], rho[3] + 0.5*h*k1[3], rho[4] + 0.5*h*k1[4], rho[5] + 0.5*h*k1[5], rho[6] + 0.5*h*k1[6], rho[7] + 0.5*h*k1[7], rho[8] + 0.5*h*k1[8], rho[9] + 0.5*h*k1[9], rho[10] + 0.5*h*k1[10], rho[11] + 0.5*h*k1[11], rho[12] + 0.5*h*k1[12], rho[13] + 0.5*h*k1[13], rho[14] + 0.5*h*k1[14], rho[15] + 0.5*h*k1[15], rho[16] + 0.5*h*k1[16], rho[17] + 0.5*h*k1[17], rho[18] + 0.5*h*k1[18], rho[19] + 0.5*h*k1[19], rho[20] + 0.5*h*k1[20], rho[21] + 0.5*h*k1[21], rho[22] + 0.5*h*k1[22], rho[23] + 0.5*h*k1[23], rho[24] + 0.5*h*k1[24], rho[25] + 0.5*h*k1[25], rho[26] + 0.5*h*k1[26], rho[27] + 0.5*h*k1[27], rho[28] + 0.5*h*k1[28], rho[29] + 0.5*h*k1[29], rho[30] + 0.5*h*k1[30], rho[31] + 0.5*h*k1[31], rho[32] + 0.5*h*k1[32], rho[33] + 0.5*h*k1[33], rho[34] + 0.5*h*k1[34], rho[35] + 0.5*h*k1[35], rho[36] + 0.5*h*k1[36], rho[37] + 0.5*h*k1[37], rho[38] + 0.5*h*k1[38], rho[39] + 0.5*h*k1[39], rho[40] + 0.5*h*k1[40], rho[41] + 0.5*h*k1[41], rho[42] + 0.5*h*k1[42], rho[43] + 0.5*h*k1[43], rho[44] + 0.5*h*k1[44], rho[45] + 0.5*h*k1[45], rho[46] + 0.5*h*k1[46], rho[47] + 0.5*h*k1[47], rho[48] + 0.5*h*k1[48], rho[49] + 0.5*h*k1[49], rho[50] + 0.5*h*k1[50], rho[51] + 0.5*h*k1[51], rho[52] + 0.5*h*k1[52], rho[53] + 0.5*h*k1[53], rho[54] + 0.5*h*k1[54], rho[55] + 0.5*h*k1[55], rho[56] + 0.5*h*k1[56], rho[57] + 0.5*h*k1[57], rho[58] + 0.5*h*k1[58], rho[59] + 0.5*h*k1[59], rho[60] + 0.5*h*k1[60], rho[61] + 0.5*h*k1[61], rho[62] + 0.5*h*k1[62], rho[63] + 0.5*h*k1[63], rho[64] + 0.5*h*k1[64], rho[65] + 0.5*h*k1[65], rho[66] + 0.5*h*k1[66], rho[67] + 0.5*h*k1[67], rho[68] + 0.5*h*k1[68], rho[69] + 0.5*h*k1[69], rho[70] + 0.5*h*k1[70], rho[71] + 0.5*h*k1[71], rho[72] + 0.5*h*k1[72], rho[73] + 0.5*h*k1[73], rho[74] + 0.5*h*k1[74], rho[75] + 0.5*h*k1[75], rho[76] + 0.5*h*k1[76], rho[77] + 0.5*h*k1[77], rho[78] + 0.5*h*k1[78], rho[79] + 0.5*h*k1[79], rho[80] + 0.5*h*k1[80], rho[81] + 0.5*h*k1[81], rho[82] + 0.5*h*k1[82], rho[83] + 0.5*h*k1[83], rho[84] + 0.5*h*k1[84], rho[85] + 0.5*h*k1[85], rho[86] + 0.5*h*k1[86], rho[87] + 0.5*h*k1[87], rho[88] + 0.5*h*k1[88], rho[89] + 0.5*h*k1[89], rho[90] + 0.5*h*k1[90], rho[91] + 0.5*h*k1[91], rho[92] + 0.5*h*k1[92], rho[93] + 0.5*h*k1[93], rho[94] + 0.5*h*k1[94], rho[95] + 0.5*h*k1[95], rho[96] + 0.5*h*k1[96], rho[97] + 0.5*h*k1[97], rho[98] + 0.5*h*k1[98], rho[99] + 0.5*h*k1[99], rho[100] + 0.5*h*k1[100], rho[101] + 0.5*h*k1[101], rho[102] + 0.5*h*k1[102], rho[103] + 0.5*h*k1[103], rho[104] + 0.5*h*k1[104], rho[105] + 0.5*h*k1[105], rho[106] + 0.5*h*k1[106], rho[107] + 0.5*h*k1[107], rho[108] + 0.5*h*k1[108], rho[109] + 0.5*h*k1[109], rho[110] + 0.5*h*k1[110], rho[111] + 0.5*h*k1[111], rho[112] + 0.5*h*k1[112], rho[113] + 0.5*h*k1[113], rho[114] + 0.5*h*k1[114], rho[115] + 0.5*h*k1[115], rho[116] + 0.5*h*k1[116], rho[117] + 0.5*h*k1[117], rho[118] + 0.5*h*k1[118], rho[119] + 0.5*h*k1[119], rho[120] + 0.5*h*k1[120], rho[121] + 0.5*h*k1[121], rho[122] + 0.5*h*k1[122], rho[123] + 0.5*h*k1[123], rho[124] + 0.5*h*k1[124], rho[125] + 0.5*h*k1[125], rho[126] + 0.5*h*k1[126], rho[127] + 0.5*h*k1[127], rho[128] + 0.5*h*k1[128], rho[129] + 0.5*h*k1[129], rho[130] + 0.5*h*k1[130], rho[131] + 0.5*h*k1[131], rho[132] + 0.5*h*k1[132], rho[133] + 0.5*h*k1[133], rho[134] + 0.5*h*k1[134], rho[135] + 0.5*h*k1[135], rho[136] + 0.5*h*k1[136], rho[137] + 0.5*h*k1[137], rho[138] + 0.5*h*k1[138], rho[139] + 0.5*h*k1[139], rho[140] + 0.5*h*k1[140], rho[141] + 0.5*h*k1[141], rho[142] + 0.5*h*k1[142], rho[143] + 0.5*h*k1[143], j);
			}

            //Step 3
			for (j=0; j<=N-1; j++)
			{
				k3[j] = bloch(rho[0] + 0.5*h*k2[0], rho[1] + 0.5*h*k2[1], rho[2] + 0.5*h*k2[2], rho[3] + 0.5*h*k2[3], rho[4] + 0.5*h*k2[4], rho[5] + 0.5*h*k2[5], rho[6] + 0.5*h*k2[6], rho[7] + 0.5*h*k2[7], rho[8] + 0.5*h*k2[8], rho[9] + 0.5*h*k2[9], rho[10] + 0.5*h*k2[10], rho[11] + 0.5*h*k2[11], rho[12] + 0.5*h*k2[12], rho[13] + 0.5*h*k2[13], rho[14] + 0.5*h*k2[14], rho[15] + 0.5*h*k2[15], rho[16] + 0.5*h*k2[16], rho[17] + 0.5*h*k2[17], rho[18] + 0.5*h*k2[18], rho[19] + 0.5*h*k2[19], rho[20] + 0.5*h*k2[20], rho[21] + 0.5*h*k2[21], rho[22] + 0.5*h*k2[22], rho[23] + 0.5*h*k2[23], rho[24] + 0.5*h*k2[24], rho[25] + 0.5*h*k2[25], rho[26] + 0.5*h*k2[26], rho[27] + 0.5*h*k2[27], rho[28] + 0.5*h*k2[28], rho[29] + 0.5*h*k2[29], rho[30] + 0.5*h*k2[30], rho[31] + 0.5*h*k2[31], rho[32] + 0.5*h*k2[32], rho[33] + 0.5*h*k2[33], rho[34] + 0.5*h*k2[34], rho[35] + 0.5*h*k2[35], rho[36] + 0.5*h*k2[36], rho[37] + 0.5*h*k2[37], rho[38] + 0.5*h*k2[38], rho[39] + 0.5*h*k2[39], rho[40] + 0.5*h*k2[40], rho[41] + 0.5*h*k2[41], rho[42] + 0.5*h*k2[42], rho[43] + 0.5*h*k2[43], rho[44] + 0.5*h*k2[44], rho[45] + 0.5*h*k2[45], rho[46] + 0.5*h*k2[46], rho[47] + 0.5*h*k2[47], rho[48] + 0.5*h*k2[48], rho[49] + 0.5*h*k2[49], rho[50] + 0.5*h*k2[50], rho[51] + 0.5*h*k2[51], rho[52] + 0.5*h*k2[52], rho[53] + 0.5*h*k2[53], rho[54] + 0.5*h*k2[54], rho[55] + 0.5*h*k2[55], rho[56] + 0.5*h*k2[56], rho[57] + 0.5*h*k2[57], rho[58] + 0.5*h*k2[58], rho[59] + 0.5*h*k2[59], rho[60] + 0.5*h*k2[60], rho[61] + 0.5*h*k2[61], rho[62] + 0.5*h*k2[62], rho[63] + 0.5*h*k2[63], rho[64] + 0.5*h*k2[64], rho[65] + 0.5*h*k2[65], rho[66] + 0.5*h*k2[66], rho[67] + 0.5*h*k2[67], rho[68] + 0.5*h*k2[68], rho[69] + 0.5*h*k2[69], rho[70] + 0.5*h*k2[70], rho[71] + 0.5*h*k2[71], rho[72] + 0.5*h*k2[72], rho[73] + 0.5*h*k2[73], rho[74] + 0.5*h*k2[74], rho[75] + 0.5*h*k2[75], rho[76] + 0.5*h*k2[76], rho[77] + 0.5*h*k2[77], rho[78] + 0.5*h*k2[78], rho[79] + 0.5*h*k2[79], rho[80] + 0.5*h*k2[80], rho[81] + 0.5*h*k2[81], rho[82] + 0.5*h*k2[82], rho[83] + 0.5*h*k2[83], rho[84] + 0.5*h*k2[84], rho[85] + 0.5*h*k2[85], rho[86] + 0.5*h*k2[86], rho[87] + 0.5*h*k2[87], rho[88] + 0.5*h*k2[88], rho[89] + 0.5*h*k2[89], rho[90] + 0.5*h*k2[90], rho[91] + 0.5*h*k2[91], rho[92] + 0.5*h*k2[92], rho[93] + 0.5*h*k2[93], rho[94] + 0.5*h*k2[94], rho[95] + 0.5*h*k2[95], rho[96] + 0.5*h*k2[96], rho[97] + 0.5*h*k2[97], rho[98] + 0.5*h*k2[98], rho[99] + 0.5*h*k2[99], rho[100] + 0.5*h*k2[100], rho[101] + 0.5*h*k2[101], rho[102] + 0.5*h*k2[102], rho[103] + 0.5*h*k2[103], rho[104] + 0.5*h*k2[104], rho[105] + 0.5*h*k2[105], rho[106] + 0.5*h*k2[106], rho[107] + 0.5*h*k2[107], rho[108] + 0.5*h*k2[108], rho[109] + 0.5*h*k2[109], rho[110] + 0.5*h*k2[110], rho[111] + 0.5*h*k2[111], rho[112] + 0.5*h*k2[112], rho[113] + 0.5*h*k2[113], rho[114] + 0.5*h*k2[114], rho[115] + 0.5*h*k2[115], rho[116] + 0.5*h*k2[116], rho[117] + 0.5*h*k2[117], rho[118] + 0.5*h*k2[118], rho[119] + 0.5*h*k2[119], rho[120] + 0.5*h*k2[120], rho[121] + 0.5*h*k2[121], rho[122] + 0.5*h*k2[122], rho[123] + 0.5*h*k2[123], rho[124] + 0.5*h*k2[124], rho[125] + 0.5*h*k2[125], rho[126] + 0.5*h*k2[126], rho[127] + 0.5*h*k2[127], rho[128] + 0.5*h*k2[128], rho[129] + 0.5*h*k2[129], rho[130] + 0.5*h*k2[130], rho[131] + 0.5*h*k2[131], rho[132] + 0.5*h*k2[132], rho[133] + 0.5*h*k2[133], rho[134] + 0.5*h*k2[134], rho[135] + 0.5*h*k2[135], rho[136] + 0.5*h*k2[136], rho[137] + 0.5*h*k2[137], rho[138] + 0.5*h*k2[138], rho[139] + 0.5*h*k2[139], rho[140] + 0.5*h*k2[140], rho[141] + 0.5*h*k2[141], rho[142] + 0.5*h*k2[142], rho[143] + 0.5*h*k2[143], j);
			}

            //Step 4
			for (j=0; j<=N-1; j++)
			{
				k4[j] = bloch(rho[0] + h*k3[0], rho[1] + h*k3[1], rho[2] + h*k3[2], rho[3] + h*k3[3], rho[4] + h*k3[4], rho[5] + h*k3[5], rho[6] + h*k3[6], rho[7] + h*k3[7], rho[8] + h*k3[8], rho[9] + h*k3[9], rho[10] + h*k3[10], rho[11] + h*k3[11], rho[12] + h*k3[12], rho[13] + h*k3[13], rho[14] + h*k3[14], rho[15] + h*k3[15], rho[16] + h*k3[16], rho[17] + h*k3[17], rho[18] + h*k3[18], rho[19] + h*k3[19], rho[20] + h*k3[20], rho[21] + h*k3[21], rho[22] + h*k3[22], rho[23] + h*k3[23], rho[24] + h*k3[24], rho[25] + h*k3[25], rho[26] + h*k3[26], rho[27] + h*k3[27], rho[28] + h*k3[28], rho[29] + h*k3[29], rho[30] + h*k3[30], rho[31] + h*k3[31], rho[32] + h*k3[32], rho[33] + h*k3[33], rho[34] + h*k3[34], rho[35] + h*k3[35], rho[36] + h*k3[36], rho[37] + h*k3[37], rho[38] + h*k3[38], rho[39] + h*k3[39], rho[40] + h*k3[40], rho[41] + h*k3[41], rho[42] + h*k3[42], rho[43] + h*k3[43], rho[44] + h*k3[44], rho[45] + h*k3[45], rho[46] + h*k3[46], rho[47] + h*k3[47], rho[48] + h*k3[48], rho[49] + h*k3[49], rho[50] + h*k3[50], rho[51] + h*k3[51], rho[52] + h*k3[52], rho[53] + h*k3[53], rho[54] + h*k3[54], rho[55] + h*k3[55], rho[56] + h*k3[56], rho[57] + h*k3[57], rho[58] + h*k3[58], rho[59] + h*k3[59], rho[60] + h*k3[60], rho[61] + h*k3[61], rho[62] + h*k3[62], rho[63] + h*k3[63], rho[64] + h*k3[64], rho[65] + h*k3[65], rho[66] + h*k3[66], rho[67] + h*k3[67], rho[68] + h*k3[68], rho[69] + h*k3[69], rho[70] + h*k3[70], rho[71] + h*k3[71], rho[72] + h*k3[72], rho[73] + h*k3[73], rho[74] + h*k3[74], rho[75] + h*k3[75], rho[76] + h*k3[76], rho[77] + h*k3[77], rho[78] + h*k3[78], rho[79] + h*k3[79], rho[80] + h*k3[80], rho[81] + h*k3[81], rho[82] + h*k3[82], rho[83] + h*k3[83], rho[84] + h*k3[84], rho[85] + h*k3[85], rho[86] + h*k3[86], rho[87] + h*k3[87], rho[88] + h*k3[88], rho[89] + h*k3[89], rho[90] + h*k3[90], rho[91] + h*k3[91], rho[92] + h*k3[92], rho[93] + h*k3[93], rho[94] + h*k3[94], rho[95] + h*k3[95], rho[96] + h*k3[96], rho[97] + h*k3[97], rho[98] + h*k3[98], rho[99] + h*k3[99], rho[100] + h*k3[100], rho[101] + h*k3[101], rho[102] + h*k3[102], rho[103] + h*k3[103], rho[104] + h*k3[104], rho[105] + h*k3[105], rho[106] + h*k3[106], rho[107] + h*k3[107], rho[108] + h*k3[108], rho[109] + h*k3[109], rho[110] + h*k3[110], rho[111] + h*k3[111], rho[112] + h*k3[112], rho[113] + h*k3[113], rho[114] + h*k3[114], rho[115] + h*k3[115], rho[116] + h*k3[116], rho[117] + h*k3[117], rho[118] + h*k3[118], rho[119] + h*k3[119], rho[120] + h*k3[120], rho[121] + h*k3[121], rho[122] + h*k3[122], rho[123] + h*k3[123], rho[124] + h*k3[124], rho[125] + h*k3[125], rho[126] + h*k3[126], rho[127] + h*k3[127], rho[128] + h*k3[128], rho[129] + h*k3[129], rho[130] + h*k3[130], rho[131] + h*k3[131], rho[132] + h*k3[132], rho[133] + h*k3[133], rho[134] + h*k3[134], rho[135] + h*k3[135], rho[136] + h*k3[136], rho[137] + h*k3[137], rho[138] + h*k3[138], rho[139] + h*k3[139], rho[140] + h*k3[140], rho[141] + h*k3[141], rho[142] + h*k3[142], rho[143] + h*k3[143], j);
			}

            //Update of the density matrix elements
            for (j=0; j<=N-1; j++)
            {
                rho[j] = rho[j] + h*(k1[j] + 2.0*k2[j] + 2.0*k3[j] + k4[j])/6.0;
            }

            t = t + h;
        }

        //Print the result on the screen
        printf("%.2f", passo*d);
        printf(" %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g\n", rho[0], rho[1], rho[2], rho[3], rho[4], rho[5], rho[6], rho[7], rho[8], rho[9], rho[10], rho[11], rho[12], rho[13], rho[14], rho[15], rho[16], rho[17], rho[18], rho[19], rho[20], rho[21], rho[22], rho[23], rho[24], rho[25], rho[26], rho[27], rho[28], rho[29], rho[30], rho[31], rho[32], rho[33], rho[34], rho[35], rho[36], rho[37], rho[38], rho[39], rho[40], rho[41], rho[42], rho[43], rho[44], rho[45], rho[46], rho[47], rho[48], rho[49], rho[50], rho[51], rho[52], rho[53], rho[54], rho[55], rho[56], rho[57], rho[58], rho[59], rho[60], rho[61], rho[62], rho[63], rho[64], rho[65], rho[66], rho[67], rho[68], rho[69], rho[70], rho[71], rho[72], rho[73], rho[74], rho[75], rho[76], rho[77], rho[78], rho[79], rho[80], rho[81], rho[82], rho[83], rho[84], rho[85], rho[86], rho[87], rho[88], rho[89], rho[90], rho[91], rho[92], rho[93], rho[94], rho[95], rho[96], rho[97], rho[98], rho[99], rho[100], rho[101], rho[102], rho[103], rho[104], rho[105], rho[106], rho[107], rho[108], rho[109], rho[110], rho[111], rho[112], rho[113], rho[114], rho[115], rho[116], rho[117], rho[118], rho[119], rho[120], rho[121], rho[122], rho[123], rho[124], rho[125], rho[126], rho[127], rho[128], rho[129], rho[130], rho[131], rho[132], rho[133], rho[134], rho[135], rho[136], rho[137], rho[138], rho[139], rho[140], rho[141], rho[142], rho[143]);


        //Print the result in the data.txt file
        fprintf(file, "%.2f", passo*d);
        fprintf(file, " %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g %g\n", rho[0], rho[1], rho[2], rho[3], rho[4], rho[5], rho[6], rho[7], rho[8], rho[9], rho[10], rho[11], rho[12], rho[13], rho[14], rho[15], rho[16], rho[17], rho[18], rho[19], rho[20], rho[21], rho[22], rho[23], rho[24], rho[25], rho[26], rho[27], rho[28], rho[29], rho[30], rho[31], rho[32], rho[33], rho[34], rho[35], rho[36], rho[37], rho[38], rho[39], rho[40], rho[41], rho[42], rho[43], rho[44], rho[45], rho[46], rho[47], rho[48], rho[49], rho[50], rho[51], rho[52], rho[53], rho[54], rho[55], rho[56], rho[57], rho[58], rho[59], rho[60], rho[61], rho[62], rho[63], rho[64], rho[65], rho[66], rho[67], rho[68], rho[69], rho[70], rho[71], rho[72], rho[73], rho[74], rho[75], rho[76], rho[77], rho[78], rho[79], rho[80], rho[81], rho[82], rho[83], rho[84], rho[85], rho[86], rho[87], rho[88], rho[89], rho[90], rho[91], rho[92], rho[93], rho[94], rho[95], rho[96], rho[97], rho[98], rho[99], rho[100], rho[101], rho[102], rho[103], rho[104], rho[105], rho[106], rho[107], rho[108], rho[109], rho[110], rho[111], rho[112], rho[113], rho[114], rho[115], rho[116], rho[117], rho[118], rho[119], rho[120], rho[121], rho[122], rho[123], rho[124], rho[125], rho[126], rho[127], rho[128], rho[129], rho[130], rho[131], rho[132], rho[133], rho[134], rho[135], rho[136], rho[137], rho[138], rho[139], rho[140], rho[141], rho[142], rho[143]);
    }

    fclose(file);

    return 0;
}
